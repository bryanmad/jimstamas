<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
	<meta content="width=device-width, initial-scale=1.0" name="viewport">
	<meta content="ie=edge" http-equiv="X-UA-Compatible">
	<title>jstamas</title>
	
	<link href='https://fonts.googleapis.com/css?family=Kalam' rel='stylesheet'>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<style>

* {
	font-family: arial;
	font-size: 4vh;
}


.highlightgray {
background: silver;	
}

.position {
    position: absolute;
    width: 1px;
    height: 1px;
    z-index: 2;
    display: none;
}

.container {
    width: 220px;
    height: auto;
    border: 1px solid black;
    background: white;
}

.container p {
    height: 30px;
    //font-size: 5vh;
    //font-family: arial;
    width: 99%;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-itemelement.s: center;
    background: white;
    color: black;
    transition: 0.2s;
}

.container p:hover {
    background: lightblue;
}

.teegroup {
	//background: gray;
	border: 2px solid black;
	border-radius: 5px;
	width: 90%;
	margin: 1vh;
	padding: 1vh;
}
rgb(245, 243, 243)
.tee {
	padding: 1vh;
}

.head {
	background: silver;
	border: 2px solid black;
	border-radius: 5px;
	width: 90%;
	margin: 1vh;
	color: black;
	padding:1vh;
}

div#msgbox {
    position:absolute;
	text-align: center;
    //display:none;
    top:10%;
    left:10%;
    width:60%; 
    //margin-left:-250px;
    border: 2px solid black;
	border-radius: 5px; 
    padding:1vh;
    background-color:white;
}

#answeryes {
	text-align: center;
	border: 2px solid black;
	border-radius: 5px;
	padding: 3vh;
	margin: 3vh;
	float: left;
	width: 20%;
}

#answerno {
	text-align: center;
	border: 2px solid black;
	border-radius: 5px;
	padding: 3vh;
	margin: 3vh;
float: right;
	width: 20%;
}







/* back arrow */
.imgbackcontainer {
	position:fixed;
    top:2vh;
    right: 5vw;
	display: flex;
	align-items: center;
    justify-content: center;
    font-size: 20vw;
    animation: fadein 1.5s;
    opacity: 1;
}

@keyframes fadein {
  0% { opacity: 0; }
  100% { opacity: 1; }
}

#my-form {
	font-family: arial;
}

</style>
</head>
<body>
<!--
<div id="dropdowncontainer">

   <div class="dropdown">
      <div class="imgbackcontainer">
      <img id="imgback" onclick= "closeDropdown()" style="border: 0; height: 20vw; width: 20vw; " src="arrow.png" alt="x">
      </div>
      <div id="myDropdown" class="dropdown-content">
-->
      <!-- populated by javascript -->
<!--
	  </div>
   </div>
</div>
-->

<div id="teecontainer">
<!-- populated by javascript -->
</div>


<!-- message box for restore -->
<!--
<div id="msgbox"><p>Previous data exists, restore ?</p>
   <p>
      <a id="answeryes" onclick=restoreTeeData()>
            Yes
      </a>
      <a id="answerno" onclick=saveTeeData()>
            No
      </a>
   </p>
</div>
-->
<!--
<iframe src="https://docs.google.com/forms/d/e/1FAIpQLScEMPkMNDTXFyUKMrfeoywXNDd_In2I5IaxK9_vClpfdi5QJw/viewform?embedded=true" width="640" height="824" frameborder="0" marginheight="0" marginwidth="0">Loadingâ€¦</iframe>
-->

		<!-- invisible but necessary for submit of data	-->
		<!-- form to construct data prior to submit -->
<!--
		<form action="https://docs.google.com/forms/d/e/1FAIpQLScEMPkMNDTXFyUKMrfeoywXNDd_In2I5IaxK9_vClpfdi5QJw/formResponse" id="my-form" method="post" name="my-form" target="my-response-iframe">
-->
			<!-- fullname, neme, hcp, tee -->
<!--
			<input id='mx970437057' name='entry.970437057' type='text' value='default'>
			<input id='mx1993210278' name='entry.1993210278' type='text' value='default'>
			<input id='mx1205777830' name='entry.1205777830' type='text' value='default'>
			<input id='mx1657395643' name='entry.1657395643' type='text' value='default'>
			
			<input type="submit"> </form>
-->
		<!-- google iframe inserted here - invisible -->
<!--
		<iframe height="500" id="my-response-iframe" name="my-response-iframe" 
        src="https://docs.google.com/forms/d/e/1FAIpQLScEMPkMNDTXFyUKMrfeoywXNDd_In2I5IaxK9_vClpfdi5QJw/viewform?embedded=true" width="500">
        </iframe>

-->

<script type="text/javascript">

// set up variables etc.

var selectedteeslotplayer = "";
var selectedteeslot = "";
var oldteeslotvalue = "";
var selectedteeslot = "a1";
var dropdownselectedplayer = "----------";
var currentteeslotid = "";
var currentdropdownname = "";

var arrPlayers = [];
var arrTeeSlots = [];
var arrOptions = [];

// get arrOptions from google
//===========================
// this code runs at startup
//===========================
//change wording to show downloading, change back when complete
// document.getElementById("dropbtn").innerText = "searching ..."
getData();
// need to set up a couple of arrays from the data in google sheets
// https://docs.google.com/spreadsheets/d/e/2PACX-1vTZXo5wqMAIQ5cdGyb_ZczrereiMQd5wGFIdNbyirolhaSJ8Fex2_-q641jVzV0Srted6EvDMtdfQE3/pub?gid=342576676&single=true&output=csv

async function getData() {
var dataStream = await fetch("https://opensheet.elk.sh/1IWb7VKBi-FWzzgMHEu1ZVi8tE684QZ_Wh-iGTNJ5ya0/teeslotscsv")
if (!dataStream.ok) {
   const message = `An error has occured: ${dataStream.status}`;
   //throw new Error(message);
   alert("error: " + message)
}
var resultsarray = await dataStream.json()
// split into separate arrays
arrPlayers = resultsarray.map(d => d.players);
//arrTeeSlots = resultsarray.map(d => d.teeslots);
arrOptions = resultsarray.map(d => d.allplayers);
// remove null items
arrPlayers = arrPlayers.filter(function(el) {return el != null;})
//arrTeeSlots = arrTeeSlots.filter(function(el) {return el != null;})
arrOptions = arrOptions.filter(function(el) {return el != null;})
// remove empty items
arrPlayers = arrPlayers.filter(function(el) {return el != "";})
//arrTeeSlots = arrTeeSlots.filter(function(el) {return el != "";})
arrOptions = arrOptions.filter(function(el) {return el != "";})               
console.log(arrPlayers)                
//console.log(arrTeeSlots)
console.log(arrOptions)                
/*                
                
			       dd = new Date();
			       day = dd.getDay();
			
		          // get rid of "old" localStorage but keep dropdown options
		          for (var i = 0; i < localStorage.length; i++) {        
                     if (localStorage.key(i).substring(0,2) == "ww") {
                         if (localStorage.key(i) !== "wwdropdown") {
                             localStorage.removeItem(localStorage.key(i));
                         } 
                     }       
                }	
	
	             // put correct wording back - signifies download completed
	             document.getElementById("dropbtn").innerText = "select player"
	
	
	*/	
	   
		start();
	

	}
	


















/*

var arrOptions=[];
arrOptions = [
"(20) John Airey",
"(20) Paul Airey",
"(20) George Airey",
"(20) Ringo Airey",
"(20) Bryan Maddison",
"(16) Dale Aitkenhead",
"(20) Dean Airey",
"(20) Johnny Airey",
"(20) James Airey",
"(9) Stephen Alldridge",
"(20) Bob Airey",
"(20) Peter Airey",
"(7) Graham Airey",
"(20) Paul Aitkenhead",
"(20) Eddie Airey",
"(20) Trevor Airey",
"(20) Norman Airey"
];
*/


function start() {

console.log("arrOptions length = " + arrOptions.length)



// add empty values to array to make multiples of 4
if (arrOptions.length%4 !== 0) {
	arrOptions.push("----------")
	console.log("1 added")
}
if (arrOptions.length%4 !== 0) {
	arrOptions.push("----------")
	console.log("1 added")
}
if (arrOptions.length%4 !== 0) {
	arrOptions.push("----------")
	console.log("1 added")
}


 console.log("arrOptions length = " + arrOptions.length)



// build a set of 4-ball tee times
var t = 0;
var teecontainer = document.getElementById("teecontainer")
for (let j = 0; j < arrOptions.length; j+=4) {
   // create a 4-ball group
 
   t++
   let outerbox = document.createElement("div");
   outerbox.id= "aa" + t;
   outerbox.className = "teegroup";
   
  
 
 
 // create a tee time
 dd=new Date(2026,5,28,3,0,0)
 var tt = ((t*8) - 8)
 ddd = addMinutes(dd,tt);

 
let heading = document.createElement("div");
heading.id= "h" + j;
heading.className = "head";
heading.innerText = "tee " + t + " at " + ddd + "pm.";
teecontainer.appendChild(heading)


//console.log(teecontainer.innerHTML)
 //console.log(teecontainer.innerHTML)
  
// then add 4 players
let box1 = document.createElement("div");
   box1.id= "a" + j;
   box1.className = "tee";
   //box.style.setProperty("--i", i);  
   //box1.setAttribute( "onclick", "javascript: selected(this.id);" );
   box1.innerText = "----------"
   outerbox.appendChild(box1);

let box2 = document.createElement("div");
   box2.id= "a" + (j+1);
   box2.className = "tee";
   //box.style.setProperty("--i", i);  
   //box2.setAttribute( "onclick", "javascript: selected(this.id);" );
   box2.innerText = "----------"
   outerbox.appendChild(box2);

let box3 = document.createElement("div");
   box3.id= "a" + (j+2);
   box3.className = "tee";
   //box.style.setProperty("--i", i);  
   //box3.setAttribute( "onclick", "javascript: selected(this.id);" );
   box3.innerText = "----------"
   outerbox.appendChild(box3);

let box4 = document.createElement("div");
   box4.id= "a" + (j+3);
   box4.className = "tee";
   //box.style.setProperty("--i", i);  
   //box4.setAttribute( "onclick", "javascript: selected(this.id);" );
   box4.innerText = "----------"
   outerbox.appendChild(box4);

teecontainer.appendChild(outerbox);

// console.log(teecontainer.innerHTML)


/*
// create dropdown
var select = document.getElementById("myDropdown");
select.innerHTML = "";
// this is what is created
//<a id="myLink1" href="#" onclick='dropSelected(this.innerText);return false;'>Graham Airey</a>
//
for(var i = 0; i < arrOptions.length; i++) {
	var el = document.createElement("a");
	el.id = "myLink" + (i);
	el.setAttribute("onclick", "dropSelected(this.innerText);return false;");
	el.setAttribute("href", "#");
	el.setAttribute("class", "mylinks");
	el.innerText = arrOptions[i];
	select.appendChild(el);
	//if(arrOptions[i][1] > 0) {
		//console.log(arrOptions[i][0] + " " + arrOptions[i][1])
		//document.getElementById("myLink" + (i)).style.color = "blue";
		//document.getElementById("myLink" + (i)).style.background = "lightBlue";
	//}
}
console.log(document.getElementById("teecontainer").innerHTML)
*/

}

// populate tee slots
for(var i = 0; i < arrOptions.length; i++) {
   document.getElementById("a" + i).innerText = arrPlayers[i];
}


/* When the user clicks on the button, 
toggle between hiding and showing the dropdown content */
//function myFunction() {
//  document.getElementById("myDropdown").classList.toggle("show");
 // document.getElementById("myDropdown").style.display = "block";
//}

// Close the dropdown if the user clicks outside of it
//window.onclick = function(event) {
//  if (event.target.matches('#dropdowmcontainer')) {
//    document.getElementById("dropdowncontainer").style.display = "none";
//  }
//}
} // end of start()







// run by clicking on tee slot
function selected(id) {
console.log("selected")

//document.getElementById("myDropdown").classList.add("show");
//resetDropdownColors()
// clicked on tee slot
// show dropdown
document.getElementById("dropdowncontainer").style.display = "block";
var temp = document.querySelectorAll(".tee");
for (var i = 0; i < temp.length; i++) {
     temp[i].classList.remove("highlightgray");
}
document.getElementById(id).classList.add("highlightgray");
currentteeslotid = id;	
// get name in current tee slot
currentteeslotname = document.getElementById(id).innerText;
// moved to dropSelected(txt)
//document.getElementById("dropdowncontainer").style.display = "none";




}


function dropSelected(txt) {

console.log("txt = " + txt)
document.getElementById(currentteeslotid).innerText = txt;
console.log("changed from " + currentteeslotname + " to " + txt);
// close dropdown
document.getElementById("dropdowncontainer").style.display = "none";
// get rid of tee highlights
var temp = document.querySelectorAll(".tee");
for (var i = 0; i < temp.length; i++) {
     temp[i].classList.remove("highlightgray");
}
// gray fade used dropdown names but still allow selection
for (var i = 0; i < temp.length; i++) {
   if (document.getElementById("a" + i).innerText !== "----------") {
	  for (var j = 0; j < arrOptions.length; j++) {
		  if (document.getElementById("myLink" + j).innerText == document.getElementById("a" + i).innerText) {
	         console.log(document.getElementById("myLink" + j).innerText + " = " + document.getElementById("a" + i).innerText);		
             //var teeslot = i;

			 document.getElementById("myLink" + j).classList.add("highlightgray");
		  }
		  if (document.getElementById("a" + i).innerText == txt) {
			  console.log("teeslot = " + i)
			  var teeslot = i;
		  }
	  }	
   }
}
var toBeSaved = txt;	

console.log("toBeSaved = " + toBeSaved);
saveTeeData(toBeSaved, teeslot);
}


















 // dropdown
 function update(a,b){
	 j=a.options.length
    for (var i=0; i<j; i++){
        b.options[i].selected=a.options[i].selected;
		if (a.options[i].selected) {
           currentdropdownname = a.options[i].value;
		   document.getElementById(currentteeslotid).innerText = currentdropdownname;
           if (a.options[i].text !== "----------") {
		       b.options[i].text = "in use";
           }
		   // hide dropdown
           document.getElementById("dropdown").style.display = "none";
		}
    }
 }
 

function closeDropdown() {
// hide dropdown
           document.getElementById("dropdowncontainer").style.display = "none";
		   //saveTeeData()
}






 
function xsaveTeeData() {
	var tempDropdownNamesarray = [];
	var tempDropdownUsedarray = [];
	var tempTeeNamesarray = [];
	var teeops = document.querySelectorAll(".mylinks");
	console.log("teeops length = " + teeops.length)
	for(var i = 0; i < arrOptions.length; i++) {
		console.log("count " + i + " " + document.getElementById("myLink" + i).classList.contains("highlightgray"))
		// array of names
		tempDropdownNamesarray.push(document.getElementById("myLink" + i).innerText);
		// array of states for now
		if (document.getElementById("myLink" + i).classList.contains("highlightgray")) {
		   tempDropdownUsedarray.push(document.getElementById("myLink" + i).innerText);
		}
		tempTeeNamesarray.push(document.getElementById("a" + i).innerText);
		localStorage.setItem("names", JSON.stringify(tempDropdownNamesarray));
		localStorage.setItem("used", JSON.stringify(tempDropdownUsedarray));
		localStorage.setItem("teenames", JSON.stringify(tempTeeNamesarray));
	}	
	document.getElementById("msgbox").style.display = "none";
	console.log(tempDropdownNamesarray)
	console.log(tempDropdownUsedarray)
	console.log(tempTeeNamesarray)
}

function xrestoreTeeData() {
	var tempDropdownNamesarray = [];
	var tempDropdownUsedarray = [];
	var tempTeeNamesarray = [];
	tempDropdownNamesarray =  JSON.parse(localStorage.getItem("names"));
	tempDropdownUsedarray =  JSON.parse(localStorage.getItem("used"));
	tempTeeNamesarray =  JSON.parse(localStorage.getItem("teenames"));
	//console.log(tempnamesarray);
	for (let i = 0; i < arrOptions.length; i++) {
		console.log("count = " + i)
		document.getElementById("myLink" + i).innerText = tempDropdownNamesarray[i];
	    if (tempDropdownUsedarray.includes(tempDropdownNamesarray[i])) {
		   document.getElementById("myLink" + i).classList.add("highlightgray");
		}
		document.getElementById("a" + i).innerText = tempTeeNamesarray[i];
		//document.getElementById("used" + i).innerText = tempusedarray[i];
		// tidy up any cyan color left over
		//document.getElementById("name" + i).style.background = "white";
	}
	//document.getElementById("msgbox").style.display = "none";
	/*
	var ops = document.querySelectorAll(".container td");
	for (let i = 0; i < ops.length; i++) {
		// array of names
		tempnamesarray.push(document.getElementById("name" + i).innerText);
		// array of hcps - states for now
		tempusedarray.push(document.getElementById("used" + i).innerText);
		
		console.log(tempnamesarray)
		console.log(tempusedarray)
		
		localStorage.setItem("names", JSON.stringify(tempnamesarray));
		localStorage.setItem("used", JSON.stringify(tempusedarray));
*/

document.getElementById("msgbox").style.display = "none";
}















 
function saveTeeData(playerx, teeslotx) {
	console.log("saveTeeData " + playerx)
	k=0;
	document.getElementById("msgbox").style.display = "none";
	
	//for(var i = 0; i < arrOptions.length; i++) {
	//if (document.getElementById("a" + i).innerText !== "----------") {
		
			
		
		k++
		var tempfullname="";
		var arrtemp = "";
		var tempname = "";
		var temphcp1 = "";
		var temphcp = "";
		var temptee = "";
		tempfullname = playerx; 
		arrtemp = tempfullname.split(" ");
		tempname = arrtemp[1] + " " + arrtemp[2]; 
		temphcp1 = arrtemp[0].replace("(","")
		temphcp = temphcp1.replace(")","")  
		temptee = "t" + teeslotx;
		
		
		
		
		
		
		   // full name
		   document.getElementById('mx970437057').value = tempfullname; 
		   // name
		   document.getElementById('mx1993210278').value = tempname; 
		   // hcp
		   document.getElementById('mx1205777830').value = temphcp; 
		   // tee
		   document.getElementById('mx1657395643').value = temptee;
		
		
	
		document.getElementById("my-form").submit();
					
					
					
	
		
   }
	
	



function restoreTeeData() {
	var tempDropdownNamesarray = [];
	var tempDropdownUsedarray = [];
	var tempTeeNamesarray = [];
	tempDropdownNamesarray =  JSON.parse(localStorage.getItem("names"));
	tempDropdownUsedarray =  JSON.parse(localStorage.getItem("used"));
	tempTeeNamesarray =  JSON.parse(localStorage.getItem("teenames"));
	//console.log(tempnamesarray);
	for (let i = 0; i < arrOptions.length; i++) {
		console.log("count = " + i)
		document.getElementById("myLink" + i).innerText = tempDropdownNamesarray[i];
	    if (tempDropdownUsedarray.includes(tempDropdownNamesarray[i])) {
		   document.getElementById("myLink" + i).classList.add("highlightgray");
		}
		document.getElementById("a" + i).innerText = tempTeeNamesarray[i];
		//document.getElementById("used" + i).innerText = tempusedarray[i];
		// tidy up any cyan color left over
		//document.getElementById("name" + i).style.background = "white";
	}
	//document.getElementById("msgbox").style.display = "none";
	/*
	var ops = document.querySelectorAll(".container td");
	for (let i = 0; i < ops.length; i++) {
		// array of names
		tempnamesarray.push(document.getElementById("name" + i).innerText);
		// array of hcps - states for now
		tempusedarray.push(document.getElementById("used" + i).innerText);
		
		console.log(tempnamesarray)
		console.log(tempusedarray)
		
		localStorage.setItem("names", JSON.stringify(tempnamesarray));
		localStorage.setItem("used", JSON.stringify(tempusedarray));
*/

document.getElementById("msgbox").style.display = "none";
}

	



/*
player+hcp
teeslot
gross individual
stableford individual
team stableford


https://docs.google.com/forms/d/e/1FAIpQLSfz52p_dFvrqm5FkV3JzYaCJxThkAjvVUmSSFpzjRMMC6d_JQ/viewform?usp=pp_url
&entry.1954606909=(20)+Bryan+Maddison
&entry.1591797769=20
&entry.1941667842=tee1
&entry.915406743=Bryan+Maddison
&entry.1395829184=95
&entry.346825177=35
&entry.391808194=5
&entry.1881482168=5
&entry.1532983560=5
&entry.277985337=5
&entry.917906590=5
&entry.153589187=5
&entry.43189841=5
&entry.1357175424=5
&entry.2019184924=5
&entry.1382979194=5
&entry.1986017502=5
&entry.911855465=5
&entry.1338821655=5
&entry.1393912228=5
&entry.202459000=5
&entry.1706696667=5
&entry.78628422=5
&entry.797223400=5
&entry.1044397246=2
&entry.1920155365=2
&entry.1954653280=2
&entry.68124863=2
&entry.137053162=2
&entry.956608476=2
&entry.1055326331=2
&entry.554410599=2
&entry.2087126963=2
&entry.890301794=2
&entry.1829721412=2
&entry.1006579216=2
&entry.191922680=2
&entry.1932648961=2
&entry.787219590=2
&entry.263137892=2
&entry.1152572682=2
&entry.889516278=2


*/



/*
https://docs.google.com/forms/d/e/1FAIpQLScEMPkMNDTXFyUKMrfeoywXNDd_In2I5IaxK9_vClpfdi5QJw/viewform?usp=pp_url
&entry.970437057=(20)+Bryan+Maddison
&entry.1993210278=Bryan+Maddison
&entry.1205777830=20
&entry.1657395643=tee1
*/


function addMinutes(date, minutes) {
    var tt = new Date(date.getTime() + minutes*60000);
	// get the current hour (from 0 to 23)
    var hour = tt.getHours();
    // get the current minute (from 0 to 59)
    var minute = tt.getMinutes();
	if (minute < 10) {
		minute = ("0" + minute);
	}
    // display the current time in the format "HH:MM"
    return(hour + ":" + minute);
}

/*
 // create a new Date object
let now = new Date();

// get the current hour (from 0 to 23)
let hour = now.getHours();

// get the current minute (from 0 to 59)
let minute = now.getMinutes();

// display the current time in the format "HH:MM"
console.log(hour + ":" + minute);
*/











 </script>
</body>
</html>
